<!doctype html>
<html lang="en" class="govuk-template no-js">
  <head>
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

    <title>Fast Startup and Shutdown Script and Concourse Pipelines - PaaS Team Manual</title>

    <link href="/stylesheets/manifest.css" rel="stylesheet" />

    <link rel="canonical" href="https://team-manual.cloud.service.gov.uk/guides/fast-startup-and-shutdown/">

      <meta name="robots" content="noindex" />
      <meta name="twitter:card" content="summary" />
      <meta name="twitter:domain" content="team-manual.cloud.service.gov.uk" />
      <meta name="twitter:image" content="https://team-manual.cloud.service.gov.uk/images/govuk-large.png" />
      <meta name="twitter:title" content="Fast Startup and Shutdown Script and Concourse Pipelines - PaaS Team Manual" />
      <meta name="twitter:url" content="https://team-manual.cloud.service.gov.uk/guides/fast-startup-and-shutdown/" />

      <meta property="og:image" content="https://team-manual.cloud.service.gov.uk/images/govuk-large.png" />
      <meta property="og:site_name" content="PaaS Team Manual" />
      <meta property="og:title" content="Fast Startup and Shutdown Script and Concourse Pipelines" />
      <meta property="og:type" content="object" />
      <meta property="og:url" content="https://team-manual.cloud.service.gov.uk/guides/fast-startup-and-shutdown/" />

    
  </head>

  <body class="govuk-template__body">
    <script>document.body.className = ((document.body.className) ? document.body.className + ' js-enabled' : 'js-enabled');</script>

    <div class="app-pane">
      <div class="app-pane__header toc-open-disabled">
        <a href="#content" class="govuk-skip-link" data-module="govuk-skip-link">Skip to main content</a>

        <header class="govuk-header app-header" role="banner" data-module="govuk-header">
  <div class="govuk-header__container govuk-header__container--full-width">
    <div class="govuk-header__logo">
      <a href="https://team-manual.cloud.service.gov.uk" class="govuk-header__link govuk-header__link--homepage">
        <span class="govuk-header__product-name">
          PaaS Team Manual
        </span>
      </a>
        <strong class="govuk-tag">Internal</strong>
    </div>
  </div>
</header>

      </div>

        <div id="toc-heading" class="toc-show fixedsticky">
          <button type="button" class="toc-show__label js-toc-show" aria-controls="toc">
            Table of contents <span class="toc-show__icon"></span>
          </button>
        </div>

      <div class="app-pane__body" data-module="in-page-navigation">
          <div class="app-pane__toc">
            <div class="toc" data-module="table-of-contents" tabindex="-1" aria-label="Table of contents" role="dialog">
              <div class="search" data-module="search" data-path-to-site-root="/">
  <form action="https://www.google.co.uk/search" method="get" role="search" class="search__form govuk-!-margin-bottom-4">
    <input type="hidden" name="as_sitesearch" value="https://team-manual.cloud.service.gov.uk"/>
    <label class="govuk-label search__label" for="search" aria-hidden="true">
      Search (via Google)
    </label>
    <input
      type="text"
      id="search" name="q"
      class="govuk-input govuk-!-margin-bottom-0 search__input"
      aria-controls="search-results"
      placeholder="Search">
    <button type="submit" class="search__button">Search</button>
  </form>
</div>

              <button type="button" class="toc__close js-toc-close" aria-controls="toc" aria-label="Hide table of contents"></button>
              <nav id="toc" class="js-toc-list toc__list" aria-labelledby="toc-heading">
                      <ul>
  <li>
    <a href="#fast-startup-and-shutdown-script-and-concourse-pipelines"><span>Fast Startup and Shutdown Script and Concourse Pipelines</span></a>
    <ul>
      <li>
        <a href="#fast-startup-and-shutdown-cf-env-group"><span>fast-startup-and-shutdown-cf-env group</span></a>
      </li>
      <li>
        <a href="#fast-startup-cf-env"><span>fast-startup-cf-env</span></a>
      </li>
      <li>
        <a href="#kick-off-startup-pipeline"><span>kick-off startup pipeline</span></a>
      </li>
      <li>
        <a href="#fast-startup-cf-env-is-triggered"><span>fast-startup-cf-env is triggered</span></a>
      </li>
      <li>
        <a href="#script-run-starts"><span>script run starts</span></a>
      </li>
      <li>
        <a href="#script-run-completes"><span>script run completes</span></a>
      </li>
    </ul>
  </li>
</ul>


              </nav>
            </div>
          </div>

        <div class="app-pane__content toc-open-disabled" aria-label="Content" tabindex="0">
          <main id="content" class="technical-documentation" data-module="anchored-headings">
              <div class="page-banner">
    <p>This is for internal use by the PaaS team. Public-facing documentation is located at <a href="https://docs.cloud.service.gov.uk">docs.cloud.service.gov.uk</a>.</p>
  </div>

  <h1 id="fast-startup-and-shutdown-script-and-concourse-pipelines">Fast Startup and Shutdown Script and Concourse Pipelines</h1>
<p>The idea of this set of processes is to save on uneccessary AWS infrastructure expendature in dev environments, and to provide an automated way to impliment a scheduled shutdown of each environment, and to provide a manual mechanism to start dev environments back up, or shut them down before the configured schedule. The <a href="https://github.com/alphagov/paas-cf/blob/main/concourse/scripts/fast-startup-and-shutdown-cf-env.sh">script</a> that is utimately run, toggles the BOSH ressurector in order to prevent it from interfering with the state changes, and powers up/down the relevant EC2 and RDS instances for the environment. The script does not affect the BOSH or Concourse instances to maintain the ability to quickly startup and shutdown each env. The cost saving is based around the fact that the majority of the cost is incurred by instances being online. Even a powered-down environment does incur some cost due to the block storage being maintained, and the BOSH and Concourse instances that are not affected.</p>
<p>Each dev environment has a fast-startup-cf-env and fast-shutdown-cf-env deployed into it&rsquo;s concourse by default, enabled or disabled by setting the environment variable ENABLE_FAST_STARTUP_AND_SHUTDOWN_CF_ENV to either true or false. These pipelines configure the shutdown process to run each day at 19:00, and allow for both the startup and shutdown processes to be run manually.</p>
<h2 id="fast-startup-and-shutdown-cf-env-group">fast-startup-and-shutdown-cf-env group</h2>
<p><a href="/screenshots/fast-start-and-shutdown-1.png" rel="noopener noreferrer"><img src="/screenshots/fast-start-and-shutdown-1.png" alt="fast-startup-and-shutdown-cf-env group" /></a></p>
<h2 id="fast-startup-cf-env">fast-startup-cf-env</h2>
<p><a href="/screenshots/fast-start-and-shutdown-2.png" rel="noopener noreferrer"><img src="/screenshots/fast-start-and-shutdown-2.png" alt="fast-startup-cf-env" /></a></p>
<h2 id="kick-off-startup-pipeline">kick-off startup pipeline</h2>
<p><a href="/screenshots/fast-start-and-shutdown-3.png" rel="noopener noreferrer"><img src="/screenshots/fast-start-and-shutdown-3.png" alt="kick-off startup pipeline" /></a></p>
<h2 id="fast-startup-cf-env-is-triggered">fast-startup-cf-env is triggered</h2>
<p><a href="/screenshots/fast-start-and-shutdown-4.png" rel="noopener noreferrer"><img src="/screenshots/fast-start-and-shutdown-4.png" alt="fast-startup-cf-env is triggered" /></a></p>
<h2 id="script-run-starts">script run starts</h2>
<p><a href="/screenshots/fast-start-and-shutdown-5.png" rel="noopener noreferrer"><img src="/screenshots/fast-start-and-shutdown-5.png" alt="script run starts" /></a></p>
<h2 id="script-run-completes">script run completes</h2>
<p><a href="/screenshots/fast-start-and-shutdown-6.png" rel="noopener noreferrer"><img src="/screenshots/fast-start-and-shutdown-6.png" alt="script run completes" /></a></p>


            
          </main>

          <aside>
          </aside>

          <footer class="govuk-footer app-footer" role="contentinfo">
  <div class="govuk-footer__meta">
    <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">

        <ul class="govuk-footer__inline-list">
            <li class="govuk-footer__inline-list-item">
              <a class="govuk-footer__link" href="/accessibility/">Accessibility</a>
            </li>
        </ul>

      <svg
        aria-hidden="true"
        focusable="false"
        class="govuk-footer__licence-logo"
        xmlns="http://www.w3.org/2000/svg"
        viewbox="0 0 483.2 195.7"
        height="17"
        width="41"
      >
        <path
          fill="currentColor"
          d="M421.5 142.8V.1l-50.7 32.3v161.1h112.4v-50.7zm-122.3-9.6A47.12 47.12 0 0 1 221 97.8c0-26 21.1-47.1 47.1-47.1 16.7 0 31.4 8.7 39.7 21.8l42.7-27.2A97.63 97.63 0 0 0 268.1 0c-36.5 0-68.3 20.1-85.1 49.7A98 98 0 0 0 97.8 0C43.9 0 0 43.9 0 97.8s43.9 97.8 97.8 97.8c36.5 0 68.3-20.1 85.1-49.7a97.76 97.76 0 0 0 149.6 25.4l19.4 22.2h3v-87.8h-80l24.3 27.5zM97.8 145c-26 0-47.1-21.1-47.1-47.1s21.1-47.1 47.1-47.1 47.2 21 47.2 47S123.8 145 97.8 145"
        />
      </svg>
      <span class="govuk-footer__licence-description">
        All content is available under the
        <a
          class="govuk-footer__link"
          href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"
          rel="license"
        >Open Government Licence v3.0</a>, except where otherwise stated
      </span>
    </div>
    <div class="govuk-footer__meta-item">
      <a
        class="govuk-footer__link govuk-footer__copyright-logo"
        href="https://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/uk-government-licensing-framework/crown-copyright/"
      >© Crown copyright</a>
    </div>
  </div>
</footer>

        </div>
      </div>
    </div>

    
    <script src="/javascripts/application.js"></script>
  </body>
</html>
