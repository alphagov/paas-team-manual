<!doctype html>
<html lang="en" class="govuk-template no-js">
  <head>
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

    <title>PaaS Team Manual</title>

    <link href="../../stylesheets/manifest.css" rel="stylesheet" />

    <link rel="canonical" href="https://team-manual.cloud.service.gov.uk/architecture_decision_records/ADR026-DNS-layout-for-UK-hosting/">

      <meta name="twitter:card" content="summary" />
      <meta name="twitter:domain" content="team-manual.cloud.service.gov.uk" />
      <meta name="twitter:image" content="https://team-manual.cloud.service.gov.uk/images/govuk-large.png" />
      <meta name="twitter:title" content="PaaS Team Manual" />
      <meta name="twitter:url" content="https://team-manual.cloud.service.gov.uk/architecture_decision_records/ADR026-DNS-layout-for-UK-hosting/" />

      <meta property="og:image" content="https://team-manual.cloud.service.gov.uk/images/govuk-large.png" />
      <meta property="og:site_name" content="PaaS Team Manual" />
      <meta property="og:type" content="object" />
      <meta property="og:url" content="https://team-manual.cloud.service.gov.uk/architecture_decision_records/ADR026-DNS-layout-for-UK-hosting/" />

    
  </head>

  <body class="govuk-template__body">
    <script>document.body.className = ((document.body.className) ? document.body.className + ' js-enabled' : 'js-enabled');</script>

    <div class="app-pane">
      <div class="app-pane__header toc-open-disabled">
        <a href="#content" class="govuk-skip-link">Skip to main content</a>

        <header class="govuk-header app-header" role="banner" data-module="govuk-header">
  <div class="govuk-header__container govuk-header__container--full-width">
    <div class="govuk-header__logo">
      <a href="https://team-manual.cloud.service.gov.uk" class="govuk-header__link govuk-header__link--homepage">
        <span class="govuk-header__product-name">
          PaaS Team Manual
        </span>
      </a>
        <strong class="govuk-tag">Internal</strong>
    </div>
  </div>
</header>

      </div>

        <div id="toc-heading" class="toc-show fixedsticky">
          <button type="button" class="toc-show__label js-toc-show" aria-controls="toc">
            Table of contents <span class="toc-show__icon"></span>
          </button>
        </div>

      <div class="app-pane__body" data-module="in-page-navigation">
          <div class="app-pane__toc">
            <div class="toc" data-module="table-of-contents" tabindex="-1" aria-label="Table of contents" role="dialog">
              
              <button type="button" class="toc__close js-toc-close" aria-controls="toc" aria-label="Hide table of contents"></button>
              <nav id="toc" class="js-toc-list toc__list" aria-labelledby="toc-heading">
                      <ul>
  <li>
    <a href="#adr026-dns-layout-for-uk-hosting"><span>ADR026: DNS layout for UK hosting</span></a>
    <ul>
      <li>
        <a href="#context"><span>Context</span></a>
      </li>
      <li>
        <a href="#decision"><span>Decision</span></a>
        <ul>
          <li>
            <a href="#examples"><span>Examples</span></a>
            <ul>
              <li>
                <a href="#production"><span>Production</span></a>
              </li>
              <li>
                <a href="#staging"><span>Staging</span></a>
              </li>
            </ul>
          </li>
        </ul>
      </li>
      <li>
        <a href="#status"><span>Status</span></a>
      </li>
      <li>
        <a href="#consequences"><span>Consequences</span></a>
      </li>
    </ul>
  </li>
</ul>


              </nav>
            </div>
          </div>

        <div class="app-pane__content toc-open-disabled">
          <main id="content" class="technical-documentation" data-module="anchored-headings">
              <div class="page-banner">
    <p>This is for internal use by the PaaS team. Public-facing documentation is located at <a href="https://docs.cloud.service.gov.uk">docs.cloud.service.gov.uk</a>.</p>
  </div>

  <h1 id="adr026-dns-layout-for-uk-hosting">ADR026: DNS layout for UK hosting</h1><h2 id="context">Context</h2><p>We are moving AWS hosting from Ireland to London. This ADR contains the decisions of the DNS names we will use for apps and system components that will be hosted in London.</p>
<h2 id="decision">Decision</h2><p>We will use the following domain patterns for the London hosting:</p>

<ul>
<li><code>(system_component).london.(system_domain)</code></li>
<li><code>(app_name).london.(app_domain)</code></li>
</ul>
<p>Where:</p>

<ul>
<li>(system_component) &ndash; api, uaa, doppler, ssh, etc.</li>
<li>(system_domain) &ndash; <em>cloud.service.gov.uk</em>, <em>staging.cloudpipeline.digital</em></li>
<li>(app_domain) &ndash; <em>cloudapps.digital</em>, <em>staging.cloudpipelineapps.digital</em></li>
</ul>
<p>The reasons are:</p>

<ul>
<li>We should re-use the (system_component) first part to minimise the changes to the Cloud Foundry manifests.</li>
<li>We should re-use the (system_domain) and (app_domain) last part, because these domains are assigned to GOV.UK PaaS as the public interface.</li>
<li>The domain part <code>london</code> is preferrable to <code>uk</code>, because AWS may provide multiple-region hosting within the UK in the future.</li>
</ul>
<p>The domain structure for the dev and CI environments won&rsquo;t change. For the dev environments we will create a flag to choose where to create the deployment.</p>
<h3 id="examples">Examples</h3><h4 id="production">Production</h4><div class="table-container">
        <table>
          <tr>
<th>Ireland</th>
<th>London</th>
</tr><tr>
<th scope="row"><em>api.cloud.service.gov.uk</em>
</th>
<td><em>api.london.cloud.service.gov.uk</em></td>
</tr><tr>
<th scope="row"><em>sample-app.cloudapps.digital</em>
</th>
<td><em>sample-app.london.cloudapps.digital</em></td>
</tr>
        </table>
      </div><h4 id="staging">Staging</h4><div class="table-container">
        <table>
          <tr>
<th>Ireland</th>
<th>London</th>
</tr><tr>
<th scope="row"><em>api.staging.cloudpipeline.digital</em>
</th>
<td><em>api.london.staging.cloudpipeline.digital</em></td>
</tr><tr>
<th scope="row"><em>sample-app.staging.cloudpipelineapps.digital</em>
</th>
<td><em>sample-app.london.staging.cloudpipelineapps.digital</em></td>
</tr>
        </table>
      </div><h2 id="status">Status</h2><p>Accepted</p>
<h2 id="consequences">Consequences</h2><p>New tenants will be encouraged to use London hosting. Plans need to be derived to notify exiting tenants to move their apps and services to London.</p>


            
          </main>

          <aside>
          </aside>

          <footer class="govuk-footer app-footer" role="contentinfo">
  <div class="govuk-footer__meta">
    <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">

        <ul class="govuk-footer__inline-list">
            <li class="govuk-footer__inline-list-item">
              <a class="govuk-footer__link" href="../../accessibility/">Accessibility</a>
            </li>
        </ul>

      <svg
        aria-hidden="true"
        focusable="false"
        class="govuk-footer__licence-logo"
        xmlns="http://www.w3.org/2000/svg"
        viewbox="0 0 483.2 195.7"
        height="17"
        width="41"
      >
        <path
          fill="currentColor"
          d="M421.5 142.8V.1l-50.7 32.3v161.1h112.4v-50.7zm-122.3-9.6A47.12 47.12 0 0 1 221 97.8c0-26 21.1-47.1 47.1-47.1 16.7 0 31.4 8.7 39.7 21.8l42.7-27.2A97.63 97.63 0 0 0 268.1 0c-36.5 0-68.3 20.1-85.1 49.7A98 98 0 0 0 97.8 0C43.9 0 0 43.9 0 97.8s43.9 97.8 97.8 97.8c36.5 0 68.3-20.1 85.1-49.7a97.76 97.76 0 0 0 149.6 25.4l19.4 22.2h3v-87.8h-80l24.3 27.5zM97.8 145c-26 0-47.1-21.1-47.1-47.1s21.1-47.1 47.1-47.1 47.2 21 47.2 47S123.8 145 97.8 145"
        />
      </svg>
      <span class="govuk-footer__licence-description">
        All content is available under the
        <a
          class="govuk-footer__link"
          href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"
          rel="license"
        >Open Government Licence v3.0</a>, except where otherwise stated
      </span>
    </div>
    <div class="govuk-footer__meta-item">
      <a
        class="govuk-footer__link govuk-footer__copyright-logo"
        href="https://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/uk-government-licensing-framework/crown-copyright/"
      >Â© Crown copyright</a>
    </div>
  </div>
</footer>

        </div>
      </div>
    </div>

    
    <script src="../../javascripts/application.js"></script>
  </body>
</html>
